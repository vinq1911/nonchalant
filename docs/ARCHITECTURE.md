<!--
If you are AI: This file describes the architecture of the nonchalant server.
It is generated by scripts/gen-docs.go and should be updated when structure changes.
-->

# Architecture

## Overview

nonchalant is a high-performance media server written in Go. It follows a modular architecture where core logic is separated from network-facing services.

## Directory Structure

- cmd/nonchalant/ - Main entrypoint that handles configuration, server startup, and graceful shutdown
- internal/config/ - YAML configuration loading and validation
- internal/server/ - HTTP server lifecycle and graceful shutdown orchestration
- internal/svc/health/ - Health check endpoint for monitoring
- internal/itest/ - Integration tests that verify server behavior

## Server Lifecycle

1. Main process loads configuration from YAML file
2. Server is created with health endpoint
3. Server starts listening on configured port
4. Shutdown handler listens for SIGINT/SIGTERM
5. On signal, server gracefully shuts down with 5-second timeout
6. Process exits cleanly

## Configuration

Configuration is loaded from YAML files with strict validation. Unknown fields are rejected. See docs/CONFIG.md for schema details.

## Future Phases

This is Phase 1. Future phases will add:
- Stream bus and registry (Phase 2)
- RTMP ingest (Phase 3)
- HTTP-FLV output (Phase 4)
- WebSocket-FLV output (Phase 5)
- RTMP relay (Phase 6)
- HTTP API (Phase 7)
- FFmpeg integration (Phase 8)
